{% block body %}
<div class="security-container">
    <h1 class="mb-4">Two-Factor Verification</h1>
    
    <div class="alert alert-info mb-4">
        <i class="bi bi-shield-lock"></i>
        We've sent a 6-digit verification code to your email address.
    </div>

    {% for flashError in app.flashes('error') %}
        <div class="alert alert-danger mb-4">{{ flashError }}</div>
    {% endfor %}
    {% for flashSuccess in app.flashes('success') %}
        <div class="alert alert-success mb-4">{{ flashSuccess }}</div>
    {% endfor %}

    <form method="post" action="{{ path('2fa_check') }}" class="mb-4">
        <input type="hidden" name="_csrf_token" value="{{ csrf_token('2fa') }}">

        <div class="form-group mb-4">
            <label for="_auth_code" class="form-label">Verification Code</label>
            <input type="text" id="_auth_code" name="_auth_code" 
                   class="form-control form-control-lg" 
                   required autofocus autocomplete="one-time-code"
                   inputmode="numeric" pattern="[0-9]*" maxlength="6"
                   placeholder="123456">
        </div>

        <button type="submit" class="btn btn-primary btn-lg w-100">
            Verify Identity
        </button>
    </form>

    <div class="text-center">
        <p class="text-muted">
            Didn't receive the code? 
            <a href="{{ path('2fa_resend') }}" class="text-decoration-none">
                Resend Verification Code
            </a>
        </p>
    </div>
</div>
{% endblock %}